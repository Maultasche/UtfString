<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>UtfString: Using Characters</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">UtfString
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Using Characters </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="Introduction"></a>
to Characters in UtfString</h1>
<p>A character is simply a series of code units that encode a character, also known as a code point. An character encoded in ASCII always consists of a single 8-bit code unit. A character encoded in UTF-16 consists of one or two 16-bit code units, whereas the same character encoded as UTF-8 consists of between one and four 8-bit code units.</p>
<p>The UtfString library does the hard work of dealing with characters encoded as a variable number of code units, allowing you to deal with much simpler string ofcharacters. UtfString hides the code units when dealing with an entire string by encapsulating them in string classes. However, you will certainly most need to look at or change individual characters. UtfString makes it easier to deal with individual characters by encapsulating the code units that encode that character inside the UtfChar classes.</p>
<h1><a class="anchor" id="UtfChar"></a>
UtfChar</h1>
<p>Much like the <a class="el" href="struct_utf_string_1_1_utf8_string.html">Utf8String </a> and <a class="el" href="struct_utf_string_1_1_utf16_string.html">Utf16String </a> classes, there are two types of character classes, <a class="el" href="class_utf_string_1_1_utf8_char.html">Utf8Char </a> and <a class="el" href="class_utf_string_1_1_utf16_char.html">Utf16Char </a>, which are very similar to each other.</p>
<p>Like a% <a class="el" href="namespace_utf_string.html">UtfString</a>, a UtfChar can be created as an empty instance using the default constructor, or can be initialized using a series of code units. As with UtfString initialization, characters can be initialized using string constants, " " and L" ", and with one-code-unit characters, can be initialized using character constants, ' ' and L' '.</p>
<p>Be careful with using character constants! They can only contain a single code unit. If you put a multi-code-unit character such as 'д' (assuming source code file is saved as UTF-8), only the first code unit will be assigned an the second code unit will be chopped off. Also, like with string constants, the code units inside the character constants depend on how the source code file is saved. The character constant 'д' will have two code units if the source code file is saved as UTF-8, resulting in one code unit being left off. That same constant will also result in problems if saved as UTF-16 because only the first byte of the 16-bit code unit will be used, resulting in a completely different character. The wide character constant L'д' will result in problems when the source code file is saved as UTF-8 because although both UTF-8 code units will fit, the UtfString classes will be expecting it to be a single UTF-16 code unit, resulting in an entirely different character. That same wide constant will work just fine when the source code file is saved as UTF-16 because that character is encoded as a single code unit.</p>
<p>So as you can see, using character constants is complex because you have to pay attention to the nature of the character (one code unit or more?), the encoding of the source code file (UTF-8 or UTF-16?), and the type of character constant (narrow or wide?). To make your life easier, we recommend that you always use string constants, even for characters, and that you follow the guidelines mentioned in our <a class="el" href="page_usingutfstringguidelines.html">Guidelines to Follow When Using UtfString</a>.</p>
<div class="fragment"><div class="line"><span class="comment">//Create an empty UTF-8 character</span></div>
<div class="line">Utf8Char utf8Character;</div>
<div class="line"></div>
<div class="line"><span class="comment">//Initialize a UTF-16 character with a character constant</span></div>
<div class="line"><span class="comment">//In this case we know that it is a one-code-unit character, but in all but the most</span></div>
<div class="line"><span class="comment">//obvious characters (basic ASCII), a string literal &quot; &quot; should be used instead.</span></div>
<div class="line">Utf16Char utf16Character = <span class="charliteral">&#39;A&#39;</span>;</div>
<div class="line"></div>
<div class="line"><span class="comment">//Assign to a UTF-8 character using a character constant.  Note that this character is</span></div>
<div class="line"><span class="comment">//only represented as a single character on the screen, but assuming the source code</span></div>
<div class="line"><span class="comment">//file is saved as UTF-8, multiple code units will be assigned.</span></div>
<div class="line">utf8Character = <span class="stringliteral">&quot;д&quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="comment">//Now assign the same thing to Utf16Char. </span></div>
<div class="line">utf16Character = <span class="stringliteral">&quot;д&quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="comment">//We can also specify the code units using escape sequences</span></div>
<div class="line">utf8Character = <span class="stringliteral">&quot;\x84\xD8&quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="comment">//This particular assignment requires a wide character string constant since we are specifying </span></div>
<div class="line"><span class="comment">//a 16-bit code unit</span></div>
<div class="line">utf16Character = L<span class="stringliteral">&quot;\x2A47&quot;</span>;</div>
</div><!-- fragment --><p>If you should assign a character a string constant containing more than one character, the first character will be used and the rest ignored.</p>
<p>Character comparison works similarly, where a UtfChar can be compared to another UtfChar or a string constant. If a <a class="el" href="class_utf_string_1_1_utf8_char.html">Utf8Char </a> is compared to a <a class="el" href="class_utf_string_1_1_utf16_char.html">Utf16Char </a>, the comparison is done on the code point value of the characters and not on the individual code units.</p>
<div class="fragment"><div class="line">Utf8Char utf8Character = <span class="stringliteral">&quot;O&quot;</span>;</div>
<div class="line">utf16Char utf16Character = <span class="stringliteral">&quot;O&quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span>(utf8Character == utf16Character)</div>
<div class="line">{</div>
<div class="line"></div>
<div class="line">}</div>
</div><!-- fragment --><p>Individual code units in a UtfChar can be retrieved and set using the indexing operator, "[]". This allows you fine control over the individual code units in a character, should you choose to do so.</p>
<div class="fragment"><div class="line"><span class="comment">//Initialize a UTF-8 string</span></div>
<div class="line">Utf8Char utf8Character = <span class="stringliteral">&quot;\x91\x88\xA8&quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="comment">//Get the second code unit</span></div>
<div class="line"><span class="keywordtype">char</span> codeUnit = utf8Character[1];</div>
<div class="line"></div>
<div class="line"><span class="comment">//Set the second code unit. Since an individual code unit is a represented by a char data type,</span></div>
<div class="line"><span class="comment">//we use a character constant, &#39; &#39;.</span></div>
<div class="line">utf8Character[1] = <span class="stringliteral">&#39;\x94&#39;</span>;</div>
</div><!-- fragment --><p>The most useful thing about characters is that you can extract them from a string. If you want to find the second character in a UtfString, just use the UtfString indexing operator, [], to get a particular character in the string.</p>
<div class="fragment"><div class="line"><span class="comment">//Get the second character in a string</span></div>
<div class="line">Utf8String utf8String = <span class="stringliteral">&quot;Monkey&quot;</span>;</div>
<div class="line">Utf8Char utf8Character = utf8String[1];</div>
<div class="line"></div>
<div class="line"><span class="comment">//You can also compare a character returned from the indexer with a string literal</span></div>
<div class="line"><span class="keywordflow">if</span>(utf8String[3] == <span class="stringliteral">&quot;n&quot;</span>)</div>
<div class="line">{</div>
<div class="line"></div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="UtfCharReference"></a>
UtfCharReference</h1>
<p>A UtfChar object is completely separate from everything else: changing the value of a UtfChar object will only change that object and have no effect anywhere else. This is generally a good thing, but it can cause problems in certain circumstances.</p>
<p>For example, the following code sets the value of a character in a string.</p>
<p><a class="anchor" id="anchor_charassignmentexample"></a></p>
<div class="fragment"><div class="line">Utf8String utf8String = <span class="stringliteral">&quot;Happy Times&quot;</span>;</div>
<div class="line">utf8String[3] = <span class="stringliteral">&quot;T&quot;</span>;</div>
</div><!-- fragment --><p>This is done through the use of the indexer operator [] in <a class="el" href="struct_utf_string_1_1_utf8_string.html">Utf8String </a>. If the indexer operator returned a <a class="el" href="class_utf_string_1_1_utf8_char.html">Utf8Char object </a>, getting the character would be just fine, but setting the character would cause unexpected behavior. The indexer would return a temporary <a class="el" href="class_utf_string_1_1_utf8_char.html">Utf8Char </a> object, whose value would then be set. The temporary object would then be subsequently destroyed. It would appear to the programmer that the character inside the string was being set, but in reality the string would remain unchanged, as it was really the value of a temporary object that was being set.</p>
<p>The STL string classes solve this problem by returning a reference to a character. Since we encapsulate the code units inside a UtfChar and code units inside a UtfString are stored in a STL string instance, we can't simply return a reference: encapsulation would be broken, making it difficult to assign a UtfChar object, and would require knowledge of how code units work, completely defeating the purpose of this library. So what we do is return an instance of a class called UtfCharReference (<a class="el" href="class_utf_string_1_1_utf8_char_reference.html">Utf8CharReference </a> for <a class="el" href="class_utf_string_1_1_utf8_char.html">Utf8Char </a> and <a class="el" href="class_utf_string_1_1_utf16_char_reference.html">Utf16CharReference </a> for <a class="el" href="class_utf_string_1_1_utf16_char.html">Utf16Char </a>), which represents a reference to a character inside a string. A UtfCharReference has a very similar interface and in most cases can be used just like a UtfChar. The difference is that changing the value of a UtfChar just changes that object, but changing a UtfCharReference causes the code units inside the string to be changed.</p>
<p>Since UtfCharReference has a very similar interface to UtfChar and has a conversion operator for automatic conversion to UtfChar, it will often remain unnoticed. The following code works without ever seeing a <a class="el" href="class_utf_string_1_1_utf8_char_reference.html">Utf8CharReference </a>, since when the Utf8String indexing operator returns a temporary <a class="el" href="class_utf_string_1_1_utf8_char_reference.html">Utf8CharReference </a> object, it is then in turn converted automatically to a <a class="el" href="class_utf_string_1_1_utf8_char.html">Utf8Char </a> via the Utf8CharReference's Utf8Char conversion operator.</p>
<div class="fragment"><div class="line">Utf8String utf8String = <span class="stringliteral">&quot;Happy Times&quot;</span>;</div>
<div class="line">Utf8Char character = utf8String[3];</div>
</div><!-- fragment --><p>The <a class="el" href="page_usingutfchars.html#anchor_charassignmentexample">code example</a> earlier in this page where a character is being set in a string works because the temporary <a class="el" href="class_utf_string_1_1_utf8_char_reference.html">Utf8CharReference </a> object returned by the indexing operator is assigned the new character value, causing the contents of the string to change.</p>
<p>The number of code units in a UtfChar can be retrieved via the size() function. The individual code units in a UtfChar can be accessed through the [] indexing operator.</p>
<div class="fragment"><div class="line"><span class="comment">//Get a character from a string and look at the first code unit</span></div>
<div class="line">Utf8String utf8String = <span class="stringliteral">&quot;Pine Tree&quot;</span>;</div>
<div class="line">Utf8Char utf8Char = utf8String[4];</div>
<div class="line"><span class="keywordtype">char</span> codeUnit = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span>(utf8Char.size() &gt; 0)</div>
<div class="line">{</div>
<div class="line">        codeUnit = utf8Char[0];</div>
<div class="line">}       </div>
<div class="line"></div>
<div class="line">assert(codeUnit = <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"></div>
<div class="line"><span class="comment">//Set the first code unit in the fifth character</span></div>
<div class="line">utf8String[4][0] = <span class="charliteral">&#39;A&#39;</span>;</div>
<div class="line"></div>
<div class="line">assert(utf8String == <span class="stringliteral">&quot;PineATree&quot;</span>);</div>
</div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Jun 22 2013 21:27:23 for UtfString by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.4
</small></address>
</body>
</html>
